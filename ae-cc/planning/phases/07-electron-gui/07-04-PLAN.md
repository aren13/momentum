# Plan 07-04: Context Inspector

**Phase:** 07 - Electron GUI
**Plan:** 07-04
**Objective:** Create a context inspector that visualizes what the AI "knows" about the codebase, showing file context status, token usage, and detailed file information.

## Context

AI agents need context from the codebase to work effectively. This plan creates a context inspector that helps users understand what files are in the AI's context, how many tokens are being used, and which files are actively being processed.

## Tasks

### Task 1: Create Context Inspector Components
**Location:** `momentum/electron/renderer/components/Context/`

Create the following React components:

1. **ContextInspector.jsx** - Main inspector view
   - Layout for tree, details, and token counter
   - Manage selected file state
   - Handle refresh and sync actions
   - Show overall context statistics

2. **ContextTree.jsx** - File tree with context status
   - Display project file tree
   - Show context status per file (in context, active, excluded)
   - Use icons/colors to indicate status
   - Support expand/collapse folders
   - Handle file selection
   - Show file size and type

3. **ContextDetails.jsx** - Detailed file information
   - Display selected file metadata
   - Show token count for file
   - Display file content preview
   - Show last modified date
   - Indicate why file is in context
   - Support actions (add/remove from context)

4. **TokenCounter.jsx** - Token usage visualization
   - Display total token usage
   - Show breakdown by file/category
   - Visualize percentage of context limit
   - Show token limit and remaining
   - Use progress bar or chart
   - Highlight high-token files

**Verification:**
- [ ] All component files created
- [ ] Components export properly
- [ ] PropTypes defined for all components
- [ ] Inspector displays context information clearly

### Task 2: Add Context Inspector Styles
**Location:** `momentum/electron/renderer/components/Context/context.css`

Create inspector styling:
- Three-panel layout (tree, details, tokens)
- File tree styling with icons
- Status indicator colors (green for active, gray for inactive, etc.)
- Details panel with clean typography
- Token visualization (progress bars, charts)
- Responsive layout for different panel sizes
- Professional information hierarchy

**Verification:**
- [ ] CSS file created
- [ ] Layout is clean and intuitive
- [ ] Status indicators are clearly visible
- [ ] Token visualization is easy to understand

### Task 3: Wire Up to Context System
**Integration:** Connect inspector to Momentum CLI context system

1. **Load Context from CLI**
   - Use IPC to fetch current context state
   - Load file tree with context annotations
   - Get token counts per file
   - Fetch context metadata
   - Handle initial load and refresh

2. **Show Token Estimates**
   - Calculate token usage for each file
   - Aggregate total token count
   - Show context window limit
   - Display remaining capacity
   - Highlight files exceeding threshold
   - Update estimates in real-time

3. **Highlight Active Files**
   - Subscribe to active file events via IPC
   - Highlight files currently being processed
   - Show which agent is using which files
   - Update highlights in real-time
   - Support filtering by active status

**Verification:**
- [ ] Context data loads from CLI
- [ ] Token counts are accurate
- [ ] Active files highlight correctly
- [ ] Real-time updates work smoothly
- [ ] Can refresh context on demand

## Success Criteria

- [ ] Context inspector displays file tree with status
- [ ] Token usage is clearly visualized
- [ ] Active files are highlighted in real-time
- [ ] File details show comprehensive information
- [ ] Inspector syncs with CLI context changes
- [ ] Performance is good with large codebases
- [ ] UI is intuitive and informative

## Dependencies

- Plan 07-01 (Electron shell, IPC bridge)
- Momentum CLI context management system
- Token counting library (e.g., gpt-tokenizer)

## Notes

- Consider lazy loading file tree for large projects
- Implement search/filter for finding specific files
- Add context actions (add file, remove file, clear context)
- Show context presets (e.g., "Full Project", "Current Phase")
- Include context health indicators (warnings for high usage)
- Add export functionality (save context snapshot)
- Consider showing context diff when it changes
