# Plan 07-03: Multi-Agent Terminal Panel

**Phase:** 07 - Electron GUI
**Plan:** 07-03
**Objective:** Create a multi-agent terminal panel that displays live output from up to 12 concurrent agent instances with tabs, ANSI support, and scrollback history.

## Context

The Momentum CLI orchestrates multiple AI agents concurrently. This plan creates a terminal panel in the Electron GUI to display live output from these agents, allowing users to monitor progress, debug issues, and switch between agent contexts.

## Tasks

### Task 1: Create Terminal Components
**Location:** `momentum/electron/renderer/components/Terminal/`

Create the following React components:

1. **TerminalPanel.jsx** - Main container
   - Manage terminal instances (up to 12)
   - Handle tab state
   - Coordinate with IPC bridge
   - Manage panel layout and resize

2. **TerminalWindow.jsx** - Single agent terminal
   - Display output for one agent
   - Handle scrolling and auto-scroll
   - Support terminal actions (clear, copy)
   - Show agent status (running, idle, error)

3. **TerminalTabs.jsx** - Tab bar component
   - Display tabs for each active agent
   - Show agent name and status indicator
   - Handle tab switching
   - Support tab close action
   - Highlight active tab

4. **TerminalOutput.jsx** - Output rendering
   - Render terminal text with ANSI support
   - Handle color codes and formatting
   - Support clickable links
   - Virtualize output for performance
   - Preserve formatting (whitespace, line breaks)

**Verification:**
- [ ] All component files created
- [ ] Components export properly
- [ ] PropTypes defined for all components
- [ ] Can display multiple terminals simultaneously

### Task 2: Add Terminal Styles
**Location:** `momentum/electron/renderer/components/Terminal/terminal.css`

Create terminal styling:
- Dark terminal theme (classic terminal look)
- Monospace font (Consolas, Monaco, or similar)
- Tab bar styling with status indicators
- Scrollbar styling
- ANSI color palette
- Resize handles and splitters
- Active/inactive terminal states

**Verification:**
- [ ] CSS file created
- [ ] Terminal has professional appearance
- [ ] ANSI colors render correctly
- [ ] Tabs are clearly distinguishable

### Task 3: Wire Up to Agent Output
**Integration:** Connect terminal panel to agent execution system

1. **Subscribe to Agent Output Events**
   - Use IPC to subscribe to `agent:output` events
   - Route output to correct terminal instance
   - Handle multiple concurrent subscriptions
   - Clean up subscriptions on unmount

2. **Live Streaming of Agent Output**
   - Stream output in real-time as agents execute
   - Buffer output for smooth rendering
   - Handle rapid output without blocking UI
   - Support partial line updates

3. **Terminal History and Scrollback**
   - Store complete output history per agent
   - Support scrollback through history
   - Implement auto-scroll to bottom (with override)
   - Limit history size (e.g., last 10,000 lines)
   - Support search within terminal output

**Verification:**
- [ ] Terminal receives live agent output
- [ ] Output streams smoothly without lag
- [ ] Scrollback works correctly
- [ ] Auto-scroll behavior is intuitive
- [ ] Can handle 12 concurrent terminals

## Success Criteria

- [ ] Terminal panel displays agent output in real-time
- [ ] Can switch between up to 12 agent terminals
- [ ] ANSI colors and formatting render correctly
- [ ] Scrollback and history work properly
- [ ] Terminal performance is smooth even with rapid output
- [ ] Tab interface is intuitive and responsive
- [ ] No memory leaks with long-running agents

## Dependencies

- Plan 07-01 (Electron shell, IPC bridge)
- Momentum CLI agent execution system
- ANSI parsing library (e.g., ansi-to-react or ansi-to-html)

## Notes

- Consider using xterm.js for full terminal emulation if needed
- Implement virtual scrolling for large output histories
- Add keyboard shortcuts for tab navigation (Ctrl+Tab, etc.)
- Include context menu for terminal actions (copy, clear, save)
- Show timestamps for agent messages (optional)
- Consider adding terminal splitting for side-by-side view
